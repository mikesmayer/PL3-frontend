(function(){"use strict";(function($){$.fn.oSlider=function(options){var settings=$.extend({minVisibleItems:1,maxVisibleItems:3},options);var slider=this,container=slider.find(".item-wrap"),list=container.find(".item-list"),items=list.children(),leftArrow=slider.find(".slider-arrow .left-arrow"),rightArrow=slider.find(".slider-arrow .right-arrow"),itemWidth,itemMargin,itemFullWidth,init=function(){slider.isSliding=false;slider.isScrolling=false;setWidths();setArrowStatus();setTouchHandlers();$(window).on("resize orientationchange",function(){setWidths();setArrowStatus()});list.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(e){if(!slider.isSliding){return}slider.isSliding=false;setArrowStatus()});list.delegate("header a","click",function(e){if($("html").hasClass("touch")){e.preventDefault()}});leftArrow.on("click touchstart",handleArrowAction);rightArrow.on("click touchstart",handleArrowAction)},getItemWidth=function(){return items.first().width()},getItemMargin=function(){return items.first().outerWidth(true)-getItemWidth()},getItemFullWidth=function(){return getItemWidth()+getItemMargin()},setArrowStatus=function(){var prevItemCount=getPrevItemCount(),nextItemCount=getNextItemCount();leftArrow.toggleClass("disabled",prevItemCount==0);rightArrow.toggleClass("disabled",nextItemCount==0)},setWidths=function(){var oldItemFullWidth=itemFullWidth||getItemWidth();itemWidth=getItemWidth();itemMargin=getItemMargin();itemFullWidth=itemWidth+itemMargin;var visibleItems=getVisibleItems(),containerWidth=visibleItems*itemFullWidth-itemMargin,listWidth=items.length*itemFullWidth;if(container.width()!=containerWidth){list.one("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(e){var left=getListLeftPosition();if(left<-itemMargin&&Math.floor(left)%itemFullWidth!=0){list.addClass("notransition");var newLeft=Math.floor(Math.abs(left)/oldItemFullWidth)*itemFullWidth*-1;list.css({left:newLeft});list[0].offsetHeight;list.removeClass("notransition")}})}container.width(containerWidth);list.width(listWidth)},getVisibleItems=function(){var leftArrowMargin=parseInt(leftArrow.css("marginRight"));var visibleItems=Math.floor((container.parent().innerWidth()-(leftArrow.outerWidth()+leftArrowMargin)*2)/itemFullWidth)||settings.minVisibleItems;return visibleItems>settings.maxVisibleItems?settings.maxVisibleItems:visibleItems},handleArrowAction=function(e){e.preventDefault();var arrow=$(e.currentTarget);if(arrow.hasClass("disabled")||slider.isSliding){return}if(arrow.hasClass("left-arrow")){slideToLeft()}else{slideToRight()}},slideToLeft=function(){var left=getListLeftPosition(),visibleItems=getVisibleItems(),prevItemCount=getPrevItemCount(),moveItems=prevItemCount>visibleItems?visibleItems:prevItemCount,newLeft=left+moveItems*itemFullWidth;if(newLeft===left){return}list.css({left:newLeft});slider.trigger("oslider.slide oslider.slideleft");slider.isSliding=true},slideToRight=function(){var left=getListLeftPosition(),visibleItems=getVisibleItems(),nextItemCount=getNextItemCount(),moveItems=nextItemCount>visibleItems?visibleItems:nextItemCount,newLeft=left-moveItems*itemFullWidth;if(newLeft===left){return}list.css({left:newLeft});slider.trigger("oslider.slide oslider.slideright");slider.isSliding=true},getListLeftPosition=function(){return list.position().left},getPrevItemCount=function(){var left=getListLeftPosition();return Math.floor(Math.abs(left)/itemFullWidth)},getNextItemCount=function(){var left=getListLeftPosition(),prevItemCount=getPrevItemCount(),visibleItems=getVisibleItems();return items.length-prevItemCount-visibleItems},setTouchHandlers=function(){container.on("touchstart",handleTouchStart);container.on("touchmove",handleTouchMove);container.on("touchend",handleTouchEnd)},isScrolling=function(y1,y2){var vertDiff=Math.abs(y1)-Math.abs(y2);if(vertDiff>1){return true}else if(vertDiff<-1){return true}return false},getTouchDeltaPosition=function(v1,v2){var d=Math.abs(v1)-Math.abs(v2);if(d<0){d*=-1}return d},handleTouchStart=function(e){var lastTouch=getLastTouchData(),newTouch={x:e.originalEvent.targetTouches[0].clientX,y:e.originalEvent.targetTouches[0].clientY,time:(new Date).getTime()};slider.isSliding=false;setLastTouchData(newTouch)},handleTouchMove=function(e){var lastTouch=getLastTouchData(),willSlide=true,newTouch={x:e.originalEvent.targetTouches[0].clientX,y:e.originalEvent.targetTouches[0].clientY,time:(new Date).getTime()};slider.isScrolling=true;if(lastTouch.x>newTouch.x){newTouch.slidingDirection="left"}else if(lastTouch.x<newTouch.x){newTouch.slidingDirection="right"}if(lastTouch.y>newTouch.y&&isScrolling(lastTouch.y,newTouch.y)){newTouch.scrollingDirection="down"}else if(lastTouch.y<newTouch.y&&isScrolling(lastTouch.y,newTouch.y)){newTouch.scrollingDirection="up"}else{newTouch.scrollingDirection=null;slider.isScrolling=false}var xDiff=getTouchDeltaPosition(lastTouch.x,newTouch.x);var yDiff=getTouchDeltaPosition(lastTouch.y,newTouch.y);if(slider.isScrolling&&willSlide){if(xDiff<yDiff){willSlide=false}else{slider.isScrolling=false}}if(!slider.isScrolling&&!willSlide){slider.isScrolling=true}if(lastTouch){var left=getListLeftPosition(),move;list.addClass("notransition");if(lastTouch.slidingDirection=="left"&&Math.abs(left)<list.width()-getVisibleItems()*itemFullWidth-itemMargin){move=left-Math.abs(xDiff);list.css({left:move})}else if(lastTouch.slidingDirection=="right"){move=left+Math.abs(xDiff);if(move<-itemMargin/2){list.css({left:move})}}}if(!slider.isScrolling){e.preventDefault()}setLastTouchData(newTouch)},handleTouchEnd=function(e){var lastTouch=getLastTouchData(),left=getListLeftPosition(),slideDiff=Math.abs(Math.floor(left+itemMargin/2))%itemFullWidth;if(list.hasClass("notransition")){list.removeClass("notransition")}if(slider.isSliding){return false}if(slider.isScrolling){slider.isScrolling=false;return true}if(lastTouch&&lastTouch.slidingDirection){var slideNext=(lastTouch.slidingDirection=="left"?Math.floor(left/itemFullWidth):Math.ceil(left/itemFullWidth))*itemFullWidth-itemMargin/2;if(slideDiff!==0&&slideNext<=-itemMargin/2){list.css({left:slideNext});slider.isSliding=true}else if(lastTouch.slidingDirection=="left"){slideToRight()}else{slideToLeft()}return false}if(e.target.nodeName==="A"){e.target.click()}},getLastTouchData=function(){return slider.data("last-touch")},setLastTouchData=function(newTouch){slider.data("last-touch",newTouch)},unsetLastTouchData=function(){slider.removeData("last-touch")};init();return this}})(jQuery);jQuery(function($){$(".oResults").oSlider()})}).call(this);